{
    "type": "bundle",
    "id": "bundle--9cda5549-03de-4783-8cac-1e8ce21dfcea",
    "objects": [
        {
            "type": "malware-behavior",
            "spec_version": "2.1",
            "id": "malware-behavior--90ebf99a-6755-4dba-a4a9-4d41ef155199",
            "created_by_ref": "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf",
            "created": "2019-08-01T00:00:00.000Z",
            "modified": "2023-09-13T00:00:00.000Z",
            "name": "Dynamic Analysis Evasion",
            "obj_defn": {
                "description": "Malware may obstruct dynamic analysis in a sandbox or virtual machine. An analyst detonates the specimen in these controlled environments to understand the malware's behavior. However, the code may exhibit a variety of anti-analysis methods, including delayed execution and code integrity checks. Additional methods are listed in the table below.\n\nSee Emulator Evasion (B0004) for an emulator-specific evasion behavior. See Conditional Execution (B0025) for a behavior that constrains dynamic execution based on environmental conditions.\n\nThe related Virtualization/Sandbox Evasion (T1497, T1633) ATT&CK techniques were defined subsequent to this MBC behavior.\n\n\nSee **Emulator Evasion ([B0004](https://github.com/MBCProject/mbc-markdown/blob/main/anti-behavioral-analysis/emulator-evasion.md))** for an emulator-specific evasion behavior, and see **Conditional Execution ([B0025](https://github.com/MBCProject/mbc-markdown/blob/main/anti-behavioral-analysis/execution-guardrails.md))** for a behavior that constrains dynamic execution based on environmental conditions. \n\nThe related **Virtualization/Sandbox Evasion ([T1497](https://attack.mitre.org/techniques/T1497/), [T1633](https://attack.mitre.org/techniques/T1633/))** ATT&CK techniques were defined subsequent to this MBC behavior.",
                "external_id": "B0003",
                "source_name": "mitre-mbc",
                "url": "https://github.com/MBCProject/mbc-markdown/blob/main/anti-behavioral-analysis/dynamic-analysis-evasion.md"
            },
            "tags": {
                "Anti-Analysis-Type": "Evasion"
            },
            "objective_refs": [
                "malware-objective--dae81749-ad62-4e47-9dd8-19e37af93b91"
            ],
            "detection_rules": [
                {
                    "api_fncs": [
                        "kernel32.Sleep",
                        "kernel32.SleepEx",
                        "kernel32.WaitForSingleObject",
                        "kernel32.SignalObjectAndWait",
                        "kernel32.WaitForSingleObjectEx",
                        "kernel32.WaitForMultipleObjects",
                        "kernel32.WaitForMultipleObjectsEx",
                        "kernel32.RegisterWaitForSingleObject",
                        "WaitOnAddress",
                        "user32.MsgWaitForMultipleObjects",
                        "user32.MsgWaitForMultipleObjectsEx",
                        "NtDelayExecution",
                        "KeWaitForSingleObject",
                        "KeDelayExecutionThread",
                        "sleep",
                        "usleep"
                    ],
                    "detect_ref": "malware-method--e2737743-1631-43d6-be67-fa60ae285b12",
                    "rule_name": "delay execution",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/lib/delay-execution.yml"
                }
            ],
            "obj_version": "2.0",
            "related_object_refs": [
                "attack-pattern--82caa33e-d11a-433a-94ea-9b5a5fbef81d",
                "attack-pattern--27d18e87-8f32-4be1-b456-39b90454360f"
            ],
            "external_references": [
                {
                    "source_name": "Joe Security",
                    "description": "\"Overloading Sandboxes - new generic Techniques to hinder Dynamic Analysis spotted in the Wild,\" Joe Security, blog, May 6 2013 [Online].",
                    "url": "https://www.joesecurity.org/blog/4310408827727907098"
                },
                {
                    "source_name": "mcafee-webcobra",
                    "description": "\"WebCobra Malware Uses Victims' Computers to Mine Cryptocurrency,\" McAfee, blog, Nov. 12, 2018 [Online].",
                    "url": "https://www.mcafee.com/blogs/other-blogs/mcafee-labs/webcobra-malware-uses-victims-computers-to-mine-cryptocurrency/"
                },
                {
                    "source_name": "singh-knives",
                    "description": "A. Singh and A. Bu, \"Hot Knives Through Butter: Evading File-based Sandboxes,\" FireEye, 2013 [Online].",
                    "url": "https://media.blackhat.com/us-13/US-13-Singh-Hot-Knives-Through-Butter-Evading-File-based-Sandboxes-WP.pdf"
                },
                {
                    "source_name": "checkpoint",
                    "description": "Check Point Research, \"CP<r>: Evasion Techniques,\" evasions.checkpoint.com, [Online].",
                    "url": "https://evasions.checkpoint.com"
                },
                {
                    "source_name": "baker",
                    "description": "B. Baker and A. Chiu, \"Threat Spotlight: Rombertik - Gazing Past the Smoke, Mirrors, and Trapdoors,\" Cisco Threat Research, blog, May 4, 2013 [Online].",
                    "url": "https://blogs.cisco.com/security/talos/rombertik"
                },
                {
                    "source_name": "joesecurity-trickbot",
                    "description": "\"TrickBot's new API-Hammering explained,\" Joe Security, blog, Jul. 13, 2020 [Online].",
                    "url": "https://www.joesecurity.org/blog/498839998833561473"
                }
            ],
            "object_marking_refs": [
                "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3"
            ],
            "extensions": {
                "extension-definition--d57b7c9c-7fa6-436b-b82c-8e6f69cdc3d0": {
                    "extension_type": "new-sdo"
                }
            }
        }
    ]
}